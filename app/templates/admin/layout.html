{% extends "base.html" %}

{% block content %}
<div class="min-h-screen bg-slate-50 dark:bg-slate-900">
    <!-- Header -->
    <header class="bg-white dark:bg-slate-800 shadow-sm border-b border-slate-200 dark:border-slate-700">
        <div class="px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <h1 class="text-xl font-semibold">The New Cantina - Admin Panel</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="text-right">
                        <span class="text-sm">{{ user.first_name }} {{ user.last_name }} ({{ user.role|capitalize }})</span>
                        <div class="text-xs text-green-600 dark:text-green-400 font-medium">
                            Balance: ${{ "%.2f"|format(user.balance) }}
                        </div>
                    </div>
                    <a href="{{ url_for('logout') }}" class="text-sm text-blue-600 hover:text-blue-800">Logout</a>
                </div>
            </div>
        </div>
    </header>
    
    <main class="p-6">
        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
            <div class="max-w-4xl mx-auto mb-6">
                {% for category, message in messages %}
                <div class="rounded-md p-4 
                    {% if category == 'success' %}bg-green-50 dark:bg-green-900 text-green-800 dark:text-green-200 border border-green-200 dark:border-green-700
                    {% elif category == 'error' %}bg-red-50 dark:bg-red-900 text-red-800 dark:text-red-200 border border-red-200 dark:border-red-700
                    {% else %}bg-blue-50 dark:bg-blue-900 text-blue-800 dark:text-blue-200 border border-blue-200 dark:border-blue-700
                    {% endif %}">
                    <div class="flex">
                        <div class="ml-3">
                            <p class="text-sm font-medium">{{ message }}</p>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
        {% endwith %}

        <!-- Admin Navigation Tabs -->
        <div class="mb-6">
            <div class="border-b border-gray-200 dark:border-gray-700">
                <nav class="-mb-px flex space-x-8" aria-label="Tabs">
                    <a href="{{ url_for('admin_dashboard') }}" class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm
                        {% if request.endpoint == 'admin_dashboard' or request.endpoint == 'create_admin_menu' %}
                            border-blue-500 text-blue-600
                        {% else %}
                            border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-200 dark:hover:border-gray-600
                        {% endif %}">
                        Manage Menus
                    </a>
                    <a href="{{ url_for('admin_users') }}" class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm
                        {% if request.endpoint == 'admin_users' %}
                            border-blue-500 text-blue-600
                        {% else %}
                            border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-200 dark:hover:border-gray-600
                        {% endif %}">
                        Manage Users
                    </a>
                </nav>
            </div>
        </div>

        {% block admin_content %}{% endblock %}
    </main>
</div>

{% block extra_scripts %}
<script>
    // Set default date for menu creation to today
    document.addEventListener('DOMContentLoaded', function() {
        const dateInput = document.getElementById('menu_date');
        if (dateInput && !dateInput.value) {
            const today = new Date();
            const year = today.getFullYear();
            const month = ('0' + (today.getMonth() + 1)).slice(-2);
            const day = ('0' + today.getDate()).slice(-2);
            dateInput.value = `${year}-${month}-${day}`;
        }
    });
</script>
{% endblock %}
{% endblock %}